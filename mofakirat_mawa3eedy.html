
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ğŸ“… Ù…ÙÙƒØ±Ø© Ù…ÙˆØ§Ø¹ÙŠØ¯ÙŠ | Amani HR</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: 'Tajawal', sans-serif; background-color: #f4f4f4; margin: 0; padding: 20px; text-align: center; }
    header img { width: 100%; max-height: 250px; object-fit: cover; display: block; }
    select, button { padding: 8px 12px; margin: 10px; font-size: 16px; }
    #calendar { display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px; max-width: 800px; margin: 20px auto; }
    .day { background: white; padding: 10px; border-radius: 8px; box-shadow: 0 1px 5px rgba(0,0,0,0.1); cursor: pointer; position: relative; }
    .day:hover { background: #e3f2fd; }
    .day small { display: block; font-size: 13px; color: #777; margin-top: 5px; }
    .dot { position: absolute; bottom: 5px; left: 50%; transform: translateX(-50%); width: 6px; height: 6px; background-color: green; border-radius: 50%; }
    .controls { margin: 20px 0; }
    h1 { color: #0d47a1; margin-top: 20px; }
    footer { margin-top: 40px; color: #777; }
    .modal { display: none; position: fixed; z-index: 999; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.4); }
    .modal-content { background: white; padding: 20px; border-radius: 10px; width: 300px; margin: 100px auto; text-align: right; }
    .modal-content input, .modal-content textarea { width: 100%; margin-bottom: 10px; padding: 8px; font-size: 14px; }
    .modal-content button { padding: 8px 16px; margin-left: 10px; }
  </style>
</head>
<body>

<header>
  <img src="https://AmaniHR.github.io/hr_work/header.png" alt="Amani HR Header">
</header>

<h1>ğŸ“… Ù…ÙÙƒØ±Ø© Ù…ÙˆØ§Ø¹ÙŠØ¯ÙŠ</h1>

<div class="controls">
  <label>Ø§Ù„Ø´Ù‡Ø±:
    <select id="monthSelect"></select>
  </label>
  <label>Ø§Ù„Ø³Ù†Ø©:
    <select id="yearSelect"></select>
  </label>
  <button onclick="renderCalendar()">Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚ÙˆÙŠÙ…</button>
</div>

<div id="calendar"></div>

<div class="text-center">
  <button onclick="downloadPDF()" style="padding: 10px 20px; font-size: 16px; margin-top: 20px;">ğŸ–¨ï¸ ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ PDF</button>
</div>

<div id="eventModal" class="modal">
  <div class="modal-content">
    <h3>Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¹Ø¯</h3>
    <p id="selectedDateText" style="color: #555;"></p>
    <input type="text" id="eventTitle" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…ÙˆØ¹Ø¯">
    <textarea id="eventNotes" rows="3" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©"></textarea>
    <button onclick="saveEvent()">Ø­ÙØ¸</button>
    <button onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
  </div>
</div>

<footer>Â© 2025 Amani HR</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script>
  const monthNames = ["ÙŠÙ†Ø§ÙŠØ±","ÙØ¨Ø±Ø§ÙŠØ±","Ù…Ø§Ø±Ø³","Ø£Ø¨Ø±ÙŠÙ„","Ù…Ø§ÙŠÙˆ","ÙŠÙˆÙ†ÙŠÙˆ","ÙŠÙˆÙ„ÙŠÙˆ","Ø£ØºØ³Ø·Ø³","Ø³Ø¨ØªÙ…Ø¨Ø±","Ø£ÙƒØªÙˆØ¨Ø±","Ù†ÙˆÙÙ…Ø¨Ø±","Ø¯ÙŠØ³Ù…Ø¨Ø±"];
  let selectedDateKey = "";

  function renderCalendar() {
    const calendar = document.getElementById("calendar");
    const month = parseInt(document.getElementById("monthSelect").value);
    const year = parseInt(document.getElementById("yearSelect").value);
    calendar.innerHTML = "";

    const firstDay = new Date(year, month, 1).getDay();
    const daysInMonth = new Date(year, month + 1, 0).getDate();

    for (let i = 0; i < firstDay; i++) {
      const empty = document.createElement("div");
      calendar.appendChild(empty);
    }

    for (let day = 1; day <= daysInMonth; day++) {
      const cell = document.createElement("div");
      cell.className = "day";
      const currentDate = new Date(year, month, day);
      const weekday = currentDate.toLocaleDateString('ar-SA', { weekday: 'long' });
      const key = currentDate.toISOString().split('T')[0];
      const stored = JSON.parse(localStorage.getItem(key));

      cell.innerHTML = `<strong>${day}</strong><small>${weekday}</small>`;
      if (stored) cell.innerHTML += '<div class="dot"></div>';

      cell.onclick = () => openModal(currentDate);
      calendar.appendChild(cell);
    }
  }

  function openModal(date) {
    selectedDateKey = date.toISOString().split('T')[0];
    document.getElementById("selectedDateText").textContent = `Ø§Ù„ØªØ§Ø±ÙŠØ®: ${selectedDateKey}`;
    document.getElementById("eventTitle").value = "";
    document.getElementById("eventNotes").value = "";
    const stored = JSON.parse(localStorage.getItem(selectedDateKey));
    if (stored) {
      document.getElementById("eventTitle").value = stored.title;
      document.getElementById("eventNotes").value = stored.notes;
    }
    document.getElementById("eventModal").style.display = "block";
  }

  function closeModal() {
    document.getElementById("eventModal").style.display = "none";
  }

  function saveEvent() {
    const title = document.getElementById("eventTitle").value;
    const notes = document.getElementById("eventNotes").value;
    if (title) {
      localStorage.setItem(selectedDateKey, JSON.stringify({ title, notes }));
    } else {
      localStorage.removeItem(selectedDateKey);
    }
    closeModal();
    renderCalendar();
  }

  function downloadPDF() {
    const element = document.getElementById("calendar");
    const opt = {
      margin:       0.3,
      filename:     'Ù…ÙÙƒØ±Ø©_Ù…ÙˆØ§Ø¹ÙŠØ¯ÙŠ.pdf',
      image:        { type: 'jpeg', quality: 0.98 },
      html2canvas:  { scale: 2 },
      jsPDF:        { unit: 'in', format: 'a4', orientation: 'portrait' }
    };
    html2pdf().set(opt).from(element).save();
  }

  window.onclick = function(event) {
    if (event.target == document.getElementById("eventModal")) closeModal();
  }

  const yearSelect = document.getElementById("yearSelect");
  const monthSelect = document.getElementById("monthSelect");
  const currentYear = new Date().getFullYear();
  for (let y = currentYear - 5; y <= currentYear + 10; y++) {
    const opt = document.createElement("option");
    opt.value = y;
    opt.textContent = y;
    yearSelect.appendChild(opt);
  }

  monthNames.forEach((name, i) => {
    const opt = document.createElement("option");
    opt.value = i;
    opt.textContent = name;
    monthSelect.appendChild(opt);
  });

  yearSelect.value = currentYear;
  monthSelect.value = new Date().getMonth();
  renderCalendar();
</script>

</body>
</html>
